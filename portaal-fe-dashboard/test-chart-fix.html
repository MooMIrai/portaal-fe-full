<!DOCTYPE html>
<html>
<head>
    <title>Chart.js Fix Test</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Chart.js Stack Overflow Fix Test</h1>
    <canvas id="testChart" width="400" height="200"></canvas>
    
    <script>
        // Test script to verify the fix works
        console.log('Testing Chart.js without recursion issues...');
        
        const ctx = document.getElementById('testChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Test 1', 'Test 2', 'Test 3'],
                datasets: [{
                    label: 'Test Data',
                    data: [10, 20, 30],
                    backgroundColor: '#3b82f6'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true
                    }
                }
            }
        });
        
        // Test multiple updates to verify no recursion
        setTimeout(() => {
            console.log('Updating chart data...');
            chart.data.datasets[0].data = [15, 25, 35];
            chart.update();
            console.log('First update completed successfully');
        }, 1000);
        
        setTimeout(() => {
            console.log('Updating chart style...');
            chart.data.datasets[0].backgroundColor = '#ef4444';
            chart.update();
            console.log('Second update completed successfully');
        }, 2000);
        
        setTimeout(() => {
            console.log('Final update test...');
            chart.data.labels = ['Updated 1', 'Updated 2', 'Updated 3'];
            chart.update();
            console.log('All tests completed successfully - no stack overflow!');
        }, 3000);
        
    </script>
</body>
</html>